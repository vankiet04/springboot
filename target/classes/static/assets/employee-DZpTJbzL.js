var j=Object.defineProperty;var f=(o,l,n)=>l in o?j(o,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[l]=n;var c=(o,l,n)=>f(o,typeof l!="symbol"?l+"":l,n);import{R as v,j as e}from"./index-BpO_ZBpg.js";import{a as y}from"./axios-Bf4ed8-h.js";import{C as b,a as N}from"./CRow-Dqnfr_wj.js";import{C as E,a as P}from"./CCardBody-CMSQjRyN.js";import{C as S}from"./CCardHeader-mgkFoPN8.js";import{a as p}from"./index.esm-B7tri5ae.js";import{C as L,a as T,b as x,c as r,d as M,e as m}from"./CTable-Nm7DNUaS.js";import{P as D}from"./Pagination-BgrqAxMU.js";import{C as I,a as w,b as R,c as A,d as k}from"./CModalTitle-B6u3slLn.js";import{C as U}from"./CForm-slcMCCNs.js";import{C as d}from"./CFormLabel-DbKX5pXu.js";import{C as g}from"./CFormInput-tNvxg6rX.js";import{C as _}from"./CFormSelect-DAzVJejd.js";import"./DefaultLayout-DLZyO0-G.js";import"./cil-user-Dlmw-Gem.js";import"./CFormControlWrapper-DFY-SP3F.js";import"./CFormControlValidation-CSCRF9kd.js";const u="http://localhost:8080/api/employees";class F{getEmployee(){return y.get(`${u}/getall`)}getEmployeeAtPage(l){return y.get(`${u}/getemployeePage?page=${l}`)}}const $=new F;class ae extends v.Component{constructor(n){super(n);c(this,"handlePageChange",(n,a)=>{this.setState({currentPage:a}),this.fetchEmployees(a)});c(this,"toggleModal",(n=null)=>{this.setState(a=>({showModal:!a.showModal,editEmployee:n,newEmployee:n||{id:"",fullName:"",birthDate:"",phoneNumber:"",email:"",gender:""}}))});c(this,"handleInputChange",n=>{const{name:a,value:t}=n.target;this.setState(s=>({newEmployee:{...s.newEmployee,[a]:t}}))});c(this,"handleSave",()=>{const{newEmployee:n,editEmployee:a}=this.state,t={id:9999,fullName:n.fullName,birthDate:n.birthDate,phoneNumber:n.phoneNumber,email:n.email,gender:n.gender,status:1};if(n.fullName==""){alert("Vui lòng nhập họ tên");return}if(n.birthDate==""){alert("Vui lòng nhập ngày sinh");return}if(n.phoneNumber==""){alert("Vui lòng nhập số điện thoại");return}if(n.email==""){alert("Vui lòng nhập email");return}if(n.gender==""){alert("Vui lòng nhập giới tính");return}a?(alert("Sửa thông tin nhân viên: "+JSON.stringify(t)),console.log("Sửa thông tin nhân viên",t),fetch(`http://localhost:8080/api/employees/update/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(i=>{console.log("data trả về nè",i),i.ok?(alert("Sửa thông tin nhân viên thành công rồi nè"),this.toggleModal(),this.fetchEmployees(this.state.currentPage)):(alert("Có lỗi xảy ra khi sửa thông tin ở trong"),console.error("Lỗi sửa thông tin:",i))}).catch(i=>{alert("Có lỗi xảy ra khi sửa thông tin"),console.error("Lỗi sửa thông tin:",i)})):(alert("Thêm thông tin nhân viên"+JSON.stringify(t)),console.log("Thêm thông tin nhân viên",t),fetch("http://localhost:8080/api/employees/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(i=>{console.log("data trả về nè",i),i.ok?(alert("Thêm thông tin nhân viên thành công rồi nè"),this.toggleModal(),this.fetchEmployees(this.state.currentPage)):(alert("Có lỗi xảy ra khi thêm thông tin nhân viên ở trong"),console.error("Lỗi thêm thông tin nhân viên:",i))}).catch(i=>{alert("Có lỗi xảy ra khi thêm thông tin nhân viên"),console.error("Lỗi thêm thông tin nhân viên:",i)}))});c(this,"handleDelete",n=>{fetch(`http://localhost:8080/api/employees/updateStatus/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:0})}).then(t=>{console.log("Response:",t),t.ok?(alert("Xóa thông tin nhân viên thành công rồi nè"),this.fetchEmployees(this.state.currentPage)):(alert("Có lỗi xảy ra khi xóa thông tin nhân viên"),console.error("Lỗi xóa thông tin nhân viên:",t))}).catch(t=>{alert("Có lỗi xảy ra khi xóa thông tin nhân viên"),console.error("Lỗi xóa thông tin nhân viên:",t)})});this.state={employees:[],currentPage:1,pageLimit:0,perPage:5,editEmployee:null,showModal:!1,newEmployee:{id:"",fullName:"",birthDate:"",phoneNumber:"",email:"",gender:""}}}componentDidMount(){$.getEmployee().then(n=>{this.setState({employees:n.data})}).catch(n=>{console.error("Lỗi fetch employees:",n)}),this.fetchEmployees(1)}fetchEmployees(n){fetch("http://localhost:8080/api/employees/getall").then(t=>t.json()).then(t=>{const s=Math.ceil(t.length/this.state.perPage);this.setState({employees:t,pageLimit:s}),alert("Danh sach nhan vien: "+JSON.stringify(t)),console.log("Danh sach nhan vien: "+t)}).catch(t=>{console.error("Lỗi fetch employees:",t)})}render(){const{employees:n,currentPage:a,pageLimit:t,showModal:s,newEmployee:i}=this.state;return Array.isArray(n)?e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(E,{children:[e.jsxs(S,{children:["Employee Information",e.jsx(p,{color:"primary",className:"float-end",onClick:()=>this.toggleModal(),children:"Thêm nhân viên"})]}),e.jsxs(P,{children:[e.jsxs(L,{children:[e.jsx(T,{children:e.jsxs(x,{children:[e.jsx(r,{children:"Mã nhân viên"}),e.jsx(r,{children:"Họ tên"}),e.jsx(r,{children:"Giới tính"}),e.jsx(r,{children:"Ngày sinh"}),e.jsx(r,{children:"Số điện thoại"}),e.jsx(r,{children:"Email"}),e.jsx(r,{children:"Hành động"})]})}),e.jsx(M,{children:n.map((h,C)=>e.jsxs(x,{children:[e.jsx(m,{children:h.id}),e.jsx(m,{children:h.fullName}),e.jsx(m,{children:h.gender}),e.jsx(m,{children:h.birthDate}),e.jsx(m,{children:h.phoneNumber}),e.jsx(m,{children:h.email}),e.jsxs(m,{children:[e.jsx(p,{color:"warning",onClick:()=>this.toggleModal(h),children:"Sửa"}),e.jsx(p,{color:"danger",onClick:()=>this.handleDelete(h.id),children:"Xóa"})]})]},C))})]}),e.jsx(D,{count:t,page:a,onChange:this.handlePageChange,variant:"outlined",shape:"rounded"})]})]})}),e.jsxs(I,{visible:s,onClose:()=>this.toggleModal(),children:[e.jsx(w,{children:e.jsx(R,{children:this.state.editEmployee?"Chỉnh sửa thông tin nhân viên":"Thêm thông tin nhân viên"})}),e.jsx(A,{children:e.jsxs(U,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"employeeName",children:"Tên nhân viên"}),e.jsx(g,{type:"text",id:"employeeName",name:"fullName",value:i.fullName,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"employeebirthDate",children:"Ngày sinh"}),e.jsx(g,{type:"text",id:"employeebirthDate",name:"birthDate",value:i.birthDate,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"employeePhoneNumber",children:"Số điện thoại"}),e.jsx(g,{type:"text",id:"employeePhoneNumber",name:"phoneNumber",value:i.phoneNumber,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"employeeEmail",children:"Email"}),e.jsx(g,{type:"text",id:"employeeEmail",name:"email",value:i.email,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"employeeGender",children:"Giới tính"}),e.jsxs(_,{id:"employeeGender",name:"gender",value:this.state.newEmployee.gender,onChange:this.handleInputChange,children:[e.jsx("option",{value:"Nam",children:"Nam"}),e.jsx("option",{value:"Nữ",children:"Nữ"})]})]})]})}),e.jsx(k,{children:e.jsx(p,{color:"primary",onClick:this.handleSave,children:this.state.editEmployee?"Cập nhật":"Lưu"})})]})]}):(console.error("Employees is not an array:",n),null)}}export{ae as default};
