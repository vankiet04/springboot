var b=Object.defineProperty;var N=(i,r,t)=>r in i?b(i,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[r]=t;var c=(i,r,t)=>N(i,typeof r!="symbol"?r+"":r,t);import{R as k,j as e}from"./index-DQkY96rc.js";import{a as C}from"./axios-Bf4ed8-h.js";import{C as y,a as P}from"./CRow-DMBw-idI.js";import{C as S,a as v}from"./CCardBody-Dka9-WXd.js";import{C as L}from"./CCardHeader-3ISR4CqK.js";import{a as g}from"./index.esm-CsVMth3X.js";import{C as T,a as M,b as p,c as o,d as D,e as l}from"./CTable-Hg-7IAkc.js";import{P as I}from"./Pagination-Db4ijxZz.js";import{C as w,a as A,b as R,c as U,d as F}from"./CModalTitle-CeHpYnfN.js";import{C as _}from"./CForm-DinUw6Fq.js";import{C as d}from"./CFormLabel-D-i2Ydtg.js";import{C as u}from"./CFormInput-2XdN1xrD.js";import{C as $}from"./CFormSelect-PnEkIC5P.js";import"./DefaultLayout-DkBJ2y_r.js";import"./cil-user-Dlmw-Gem.js";import"./CFormControlWrapper-C9xCSD9I.js";import"./CFormControlValidation-D6H3tTV0.js";const x="http://localhost:8080/api/customers";class H{getCustomer(){return C.get(`${x}/getall`)}getCustomerAtPage(r){return C.get(`${x}/getCustomerPage?page=${r}`)}}const j=new H;class ae extends k.Component{constructor(t){super(t);c(this,"handlePageChange",(t,h)=>{this.setState({currentPage:h})});c(this,"toggleModal",(t=null)=>{this.setState(h=>({showModal:!h.showModal,editCustomer:t,newCustomer:t||{id:"",fullName:"",birthDate:"",phoneNumber:"",email:"",gender:""}}))});c(this,"handleInputChange",t=>{const{name:h,value:n}=t.target;this.setState(m=>({newCustomer:{...m.newCustomer,[h]:n}}))});c(this,"handleSave",()=>{const{newCustomer:t,editCustomer:h}=this.state,n={id:9999,fullName:t.fullName,birthDate:t.birthDate,phoneNumber:t.phoneNumber,email:t.email,gender:t.gender,status:1};if(t.fullName===""){alert("Vui lòng nhập họ tên");return}if(t.birthDate===""){alert("Vui lòng nhập ngày sinh");return}if(t.phoneNumber===""){alert("Vui lòng nhập số điện thoại");return}if(t.email===""){alert("Vui lòng nhập email");return}if(t.gender===""){alert("Vui lòng nhập giới tính");return}h?(alert("Sửa thông tin khách hàng: "+JSON.stringify(n)),console.log("Sửa thông tin khách hàng",n),fetch(`http://localhost:8080/api/customers/update/${h.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(a=>{console.log("data trả về nè",a),a.ok?(alert("Sửa thông tin khách hàng thành công rồi nè"),this.toggleModal(),this.fetchCustomers(this.state.currentPage)):(alert("Có lỗi xảy ra khi sửa thông tin ở trong"),console.error("Lỗi sửa thông tin:",a))}).catch(a=>{alert("Có lỗi xảy ra khi sửa thông tin"),console.error("Lỗi sửa thông tin:",a)})):(alert("Thêm thông tin khách hàng"+JSON.stringify(n)),console.log("Thêm thông tin khách hàng",n),fetch("http://localhost:8080/api/customers/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(a=>{console.log("data trả về nè",a),a.ok?(alert("Thêm thông tin khách hàng thành công rồi nè"),this.toggleModal(),this.fetchCustomers(this.state.currentPage)):(alert("Có lỗi xảy ra khi thêm thông tin khách hàng ở trong"),console.error("Lỗi thêm thông tin khách hàng:",a))}).catch(a=>{alert("Có lỗi xảy ra khi thêm thông tin khách hàng"),console.error("Lỗi thêm thông tin khách hàng:",a)}))});c(this,"handleDelete",t=>{fetch(`http://localhost:8080/api/customers/updateStatus/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:0})}).then(n=>{console.log("Response:",n),n.ok?(alert("Xóa thông tin khách hàng thành công rồi nè"),this.fetchCustomers(this.state.currentPage)):(alert("Có lỗi xảy ra khi xóa thông tin khách hàng"),console.error("Lỗi xóa thông tin khách hàng:",n))}).catch(n=>{alert("Có lỗi xảy ra khi xóa thông tin khách hàng"),console.error("Lỗi xóa thông tin khách hàng:",n)})});this.state={customers:[],currentPage:1,pageLimit:0,perPage:5,editCustomer:null,showModal:!1,newCustomer:{id:"",fullName:"",birthDate:"",phoneNumber:"",email:"",gender:""}}}componentDidMount(){j.getCustomer().then(t=>{const{data:h}=t,n=Math.ceil(h.length/this.state.perPage);this.setState({pageLimit:n})}).catch(t=>{console.error("Lỗi fetch customers:",t)}),this.fetchCustomers(1)}componentDidUpdate(t,h){h.currentPage!==this.state.currentPage&&this.fetchCustomers(this.state.currentPage)}fetchCustomers(t){j.getCustomerAtPage(t).then(h=>{const{data:n}=h;this.setState({customers:n})}).catch(h=>{console.error("Lỗi fetch customers:",h)})}render(){const{customers:t,currentPage:h,pageLimit:n,showModal:m,newCustomer:a}=this.state;return Array.isArray(t)?e.jsxs(y,{children:[e.jsx(P,{children:e.jsxs(S,{children:[e.jsxs(L,{children:["Customer Information",e.jsx(g,{color:"primary",className:"float-end",onClick:()=>this.toggleModal(),children:"Thêm khách hàng"})]}),e.jsxs(v,{children:[e.jsxs(T,{children:[e.jsx(M,{children:e.jsxs(p,{children:[e.jsx(o,{children:"Mã khách hàng"}),e.jsx(o,{children:"Họ tên"}),e.jsx(o,{children:"Giới tính"}),e.jsx(o,{children:"Ngày sinh"}),e.jsx(o,{children:"Số điện thoại"}),e.jsx(o,{children:"Email"}),e.jsx(o,{children:"Hành động"})]})}),e.jsx(D,{children:t.map((s,f)=>e.jsxs(p,{children:[e.jsx(l,{children:s.id}),e.jsx(l,{children:s.fullName}),e.jsx(l,{children:s.gender}),e.jsx(l,{children:s.birthDate}),e.jsx(l,{children:s.phoneNumber}),e.jsx(l,{children:s.email}),e.jsxs(l,{children:[e.jsx(g,{color:"warning",onClick:()=>this.toggleModal(s),children:"Sửa"}),e.jsx(g,{color:"danger",onClick:()=>this.handleDelete(s.id),children:"Xóa"})]})]},f))})]}),e.jsx(I,{count:n,page:h,onChange:this.handlePageChange,variant:"outlined",shape:"rounded"})]})]})}),e.jsxs(w,{visible:m,onClose:()=>this.toggleModal(),children:[e.jsx(A,{children:e.jsx(R,{children:this.state.editCustomer?"Chỉnh sửa thông tin khách hàng":"Thêm thông tin khách hàng"})}),e.jsx(U,{children:e.jsxs(_,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerName",children:"Tên khách hàng"}),e.jsx(u,{type:"text",id:"customerName",name:"fullName",value:a.fullName,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerbirthDate",children:"Ngày sinh"}),e.jsx(u,{type:"text",id:"customerbirthDate",name:"birthDate",value:a.birthDate,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerPhoneNumber",children:"Số điện thoại"}),e.jsx(u,{type:"text",id:"customerPhoneNumber",name:"phoneNumber",value:a.phoneNumber,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerEmail",children:"Email"}),e.jsx(u,{type:"text",id:"customerEmail",name:"email",value:a.email,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"customerGender",children:"Giới tính"}),e.jsxs($,{id:"customerGender",name:"gender",value:a.gender,onChange:this.handleInputChange,children:[e.jsx("option",{value:"",children:"Chọn giới tính"}),e.jsx("option",{value:"0",children:"Nam"}),e.jsx("option",{value:"1",children:"Nữ"})]})]})]})}),e.jsx(F,{children:e.jsx(g,{color:"primary",onClick:this.handleSave,children:this.state.editCustomer?"Cập nhật":"Lưu"})})]})]}):(console.error("Customers is not an array:",t),null)}}export{ae as default};
