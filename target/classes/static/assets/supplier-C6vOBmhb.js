var f=Object.defineProperty;var P=(s,r,t)=>r in s?f(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t;var h=(s,r,t)=>P(s,typeof r!="symbol"?r+"":r,t);import{R as y,j as e}from"./index-BYDUmWHQ.js";import{a as m}from"./axios-Bf4ed8-h.js";import{C as b,a as N}from"./CRow-BFNj00sZ.js";import{C as T,a as L}from"./CCardBody-ss9n7PLd.js";import{C as v}from"./CCardHeader-CCUAv6yv.js";import{a as d}from"./index.esm-XWd-aNZ_.js";import{C as M,a as A,b as x,c as o,d as w,e as c}from"./CTable-DQZ9k0Ga.js";import{P as I}from"./Pagination-lRctP_gL.js";import{C as k,a as R,b as U,c as _,d as $}from"./CModalTitle-y2EgNCjR.js";import{C as F}from"./CForm-DGHX0QGP.js";import{C as g}from"./CFormLabel-CWMvTmHP.js";import{C as u}from"./CFormInput-CkUfXBBi.js";import"./DefaultLayout-BohnMtR1.js";import"./cil-user-Dlmw-Gem.js";import"./CFormControlWrapper-CI6zFYIG.js";import"./CFormControlValidation-C1xBt7Zv.js";const C="http://localhost:8080/api/suppliers";class D{getSupplier(){return m.get(`${C}/getall`)}getSupplierAtPage(r){return m.get(`${C}/getSupplierPage?page=${r}`)}}const j=new D;class ne extends y.Component{constructor(t){super(t);h(this,"handlePageChange",(t,a)=>{this.setState({currentPage:a})});h(this,"toggleModal",(t=null)=>{this.setState(a=>({showModal:!a.showModal,editSupplier:t,newSupplier:t||{id:"",name:"",address:"",email:"",phoneNumber:""}}))});h(this,"handleInputChange",t=>{const{name:a,value:n}=t.target;this.setState(p=>({newSupplier:{...p.newSupplier,[a]:n}}))});h(this,"handleSave",()=>{const{newSupplier:t,editSupplier:a}=this.state,n={id:9999,name:t.name,address:t.address,email:t.email,phoneNumber:t.phoneNumber,status:1};if(t.name==""){alert("Vui lòng nhập họ tên");return}if(t.address==""){alert("Vui lòng nhập địa chỉ");return}if(t.email==""){alert("Vui lòng nhập email");return}if(t.phoneNumber==""){alert("Vui lòng nhập số điện thoại");return}a?(alert("Sửa thông tin nhà cung cấp: "+JSON.stringify(n)),console.log("Sửa thông tin nhà cung cấp",n),fetch(`http://localhost:8080/api/suppliers/update/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(i=>{console.log("data trả về nè",i),i.ok?(alert("Sửa thông tin nhà cung cấp thành công rồi nè"),this.toggleModal(),this.fetchSuppliers(this.state.currentPage)):(alert("Có lỗi xảy ra khi sửa thông tin ở trong"),console.error("Lỗi sửa thông tin:",i))}).catch(i=>{alert("Có lỗi xảy ra khi sửa thông tin"),console.error("Lỗi sửa thông tin:",i)})):(alert("Thêm thông tin nhà cung cấp"+JSON.stringify(n)),console.log("Thêm thông tin nhà cung cấp",n),fetch("http://localhost:8080/api/suppliers/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(i=>{console.log("data trả về nè",i),i.ok?(alert("Thêm thông tin nhà cung cấp thành công rồi nè"),this.toggleModal(),this.fetchSuppliers(this.state.currentPage)):(alert("Có lỗi xảy ra khi thêm thông tin nhà cung cấp ở trong"),console.error("Lỗi thêm thông tin nhà cung cấp:",i))}).catch(i=>{alert("Có lỗi xảy ra khi thêm thông tin nhà cung cấp"),console.error("Lỗi thêm thông tin nhà cung cấp:",i)}))});h(this,"handleDelete",t=>{fetch(`http://localhost:8080/api/suppliers/updateStatus/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:0})}).then(n=>{console.log("Response:",n),n.ok?(alert("Xóa thông tin nhà cung cấp thành công rồi nè"),this.fetchSuppliers(this.state.currentPage)):(alert("Có lỗi xảy ra khi xóa thông tin nhà cung cấp"),console.error("Lỗi xóa thông tin nhà cung cấp:",n))}).catch(n=>{alert("Có lỗi xảy ra khi xóa thông tin nhà cung cấp"),console.error("Lỗi xóa thông tin nhà cung cấp:",n)})});this.state={suppliers:[],currentPage:1,pageLimit:0,perPage:5,editSupplier:null,showModal:!1,newSupplier:{id:"",name:"",address:"",email:"",phoneNumber:""}}}componentDidMount(){j.getSupplier().then(t=>{const{data:a}=t,n=Math.ceil(a.length/this.state.perPage);this.setState({pageLimit:n})}).catch(t=>{console.error("Lỗi fetch suppliers:",t)}),this.fetchSuppliers(1)}componentDidUpdate(t,a){a.currentPage!==this.state.currentPage&&this.fetchSuppliers(this.state.currentPage)}fetchSuppliers(t){j.getSupplierAtPage(t).then(a=>{const{data:n}=a;this.setState({suppliers:n})}).catch(a=>{console.error("Lỗi fetch suppliers:",a)})}render(){const{suppliers:t,currentPage:a,pageLimit:n,showModal:p,newSupplier:i}=this.state;return Array.isArray(t)?e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(T,{children:[e.jsxs(v,{children:["Supplier Information",e.jsx(d,{color:"primary",className:"float-end",onClick:()=>this.toggleModal(),children:"Thêm nhà cung cấp"})]}),e.jsxs(L,{children:[e.jsxs(M,{children:[e.jsx(A,{children:e.jsxs(x,{children:[e.jsx(o,{children:"Mã nhà cung cấp"}),e.jsx(o,{children:"Tên nhà cung cấp"}),e.jsx(o,{children:"Địa chỉ"}),e.jsx(o,{children:"Email"}),e.jsx(o,{children:"Số điện thoại"}),e.jsx(o,{children:"Hành động"})]})}),e.jsx(w,{children:t.map((l,S)=>e.jsxs(x,{children:[e.jsx(c,{children:l.id}),e.jsx(c,{children:l.name}),e.jsx(c,{children:l.address}),e.jsx(c,{children:l.email}),e.jsx(c,{children:l.phoneNumber}),e.jsxs(c,{children:[e.jsx(d,{color:"warning",onClick:()=>this.toggleModal(l),children:"Sửa"}),e.jsx(d,{color:"danger",onClick:()=>this.handleDelete(l.id),children:"Xóa"})]})]},S))})]}),e.jsx(I,{count:n,page:a,onChange:this.handlePageChange,variant:"outlined",shape:"rounded"})]})]})}),e.jsxs(k,{visible:p,onClose:()=>this.toggleModal(),children:[e.jsx(R,{children:e.jsx(U,{children:this.state.editSupplier?"Chỉnh sửa thông tin nhà cung cấp":"Thêm thông tin nhà cung cấp"})}),e.jsx(_,{children:e.jsxs(F,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(g,{htmlFor:"supplierName",children:"Tên nhà cung cấp"}),e.jsx(u,{type:"text",id:"supplierName",name:"name",value:i.name,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(g,{htmlFor:"supplierAddress",children:"Địa chỉ"}),e.jsx(u,{type:"text",id:"supplierAddress",name:"address",value:i.address,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(g,{htmlFor:"supplierEmail",children:"Email"}),e.jsx(u,{type:"text",id:"supplierEmail",name:"email",value:i.email,onChange:this.handleInputChange})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(g,{htmlFor:"supplierPhoneNumber",children:"Số điện thoại"}),e.jsx(u,{type:"text",id:"supplierPhoneNumber",name:"phoneNumber",value:i.phoneNumber,onChange:this.handleInputChange})]})]})}),e.jsx($,{children:e.jsx(d,{color:"primary",onClick:this.handleSave,children:this.state.editSupplier?"Cập nhật":"Lưu"})})]})]}):(console.error("Suppliers is not an array:",t),null)}}export{ne as default};
